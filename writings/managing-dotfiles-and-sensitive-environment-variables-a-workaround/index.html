<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <meta name="author" content="Aryan Ahmed" />
<meta name="author" content="Aryan Ahmed" />
<meta name="author" content="Aryan Ahmed" />
<meta name="author" content="Aryan Ahmed" />
<meta property="og:type" content="website" />
<meta name="author" content="Aryan Ahmed" />
<meta property="article:Building projectlighthouse - commitment towards correctness" content="Building projectlighthouse - commitment towards correctness" />
<meta name="author" content="Aryan Ahmed" />
<meta property="article:localhost and 127.0.0.1" content="localhost and 127.0.0.1" />
<meta name="author" content="Aryan Ahmed" />
<meta property="article:An 8-Minute Query Optimization Attempt" content="An 8-Minute Query Optimization Attempt" />
<meta name="author" content="Aryan Ahmed" />
<meta property="article:Transmitting Morse Code from the Lighthouse" content="Transmitting Morse Code from the Lighthouse" />
<title>Managing Dotfiles and Sensitive Environment Variables: A Workaround</title>
<meta property="og:title" content="Managing Dotfiles and Sensitive Environment Variables: A Workaround" />
<meta name="twitter:title" content="Managing Dotfiles and Sensitive Environment Variables: A Workaround" />
<meta name="embedx:title" content="Managing Dotfiles and Sensitive Environment Variables: A Workaround" />
<meta name="description" content="The ProblemShell RC file এর থাকা Secret Token বা API Key কি git এ commit করেন? করলে github/lab এর flag করার কথা। কিছু API key/token sh..." />
<meta property="og:description" content="The ProblemShell RC file এর থাকা Secret Token বা API Key কি git এ commit করেন? করলে github/lab এর flag করার কথা। কিছু API key/token sh..." />
<meta name="twitter:description" content="The ProblemShell RC file এর থাকা Secret Token বা API Key কি git এ commit করেন? করলে github/lab এর flag করার কথা। কিছু API key/token sh..." />
<meta name="embedx:description" content="The ProblemShell RC file এর থাকা Secret Token বা API Key কি git এ commit করেন? করলে github/lab এর flag করার কথা। কিছু API key/token sh..." />
<meta name="author" content="Aryan Ahmed" />
<meta name="twitter:card" content="The ProblemShell RC file এর থাকা Secret Token বা API Key কি git এ commit করেন? করলে github/lab এর flag করার কথা। কিছু API key/token sh..." />
<meta property="og:site_name" content="thearyanahmed.com" />
<link rel="canonical" href="https://thearyanahmed.substack.com/p/managing-dotfiles-and-sensitive-environment" />
<meta property="article:Managing Dotfiles and Sensitive Environment Variables: A Workaround" content="Managing Dotfiles and Sensitive Environment Variables: A Workaround" />

    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
    <link href="https://thearyanahmed.com/css/app.css" rel="stylesheet">

    

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-90CDQWTTNW"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'G-90CDQWTTNW');
</script>
</head>

<body class="antialiased dotted-bg text-slate-500 dark:text-slate-400 bg-white dark:bg-slate-900">

    <div
    class="notsticky top-0 z-40 w-full backdrop-blur flex-none transition-colors duration-500 lg:z-50 bg-white/95 supports-backdrop-blur:bg-white/60 dark:bg-transparent">
    <nav class="w-full mx-auto bg-white">
        <div class="px-2 sm:px-6 lg:px-8 dotted-bg">
            <div class="relative flex justify-between h-16">
                <div class="absolute inset-y-0 left-0 flex items-center sm:hidden">
                    <!-- Mobile menu button -->
                    <button onclick="toggleMobileMenu()" type="button"
                        class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-gray-500"
                        aria-controls="mobile-menu" aria-expanded="false">
                        <span class="sr-only">Open main menu</span>
                        <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 6h16M4 12h16M4 18h16" />
                        </svg>

                        <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                <div class="flex-1 flex items-center justify-center sm:items-stretch sm:justify-start">
                    <div class="justify-center w-full mx-auto hidden sm:ml-6 sm:flex sm:space-x-8">
                        <a href="https://thearyanahmed.com" title="thearyanahmed's blog" target="_self"
                            class="text-gray-800 hover:underline font-semibold text-opacity-75 inline-flex items-center px-1 pt-1 text-base">
                            home
                        </a>
                        <a href="https://thearyanahmed.com/writings" title="Technical Writings"
                            class="text-gray-800 hover:underline font-semibold text-opacity-75 inline-flex items-center px-1 pt-1 text-base">
                            technical writings
                        </a>
                        <a href="https://thearyanahmed.com/abcd" title="ABCD for Kids"
                            class="text-gray-800 hover:underline font-semibold text-opacity-75 inline-flex items-center px-1 pt-1 text-base">
                            abcd for kids
                        </a>

                        
                        


                        <a href="https://github.com/thearyanahmed" title="thearyanahmed's github"
                            class="text-gray-900 inline-flex items-center px-1 pt-1 text-base" target="_blank">
                            <svg width="24" height="24" fill="currentColor"
                                class="text-gray-800 hover:underline mr-3 text-opacity-50 transform">
                                <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M12 2C6.477 2 2 6.463 2 11.97c0 4.404 2.865 8.14 6.839 9.458.5.092.682-.216.682-.48 0-.236-.008-.864-.013-1.695-2.782.602-3.369-1.337-3.369-1.337-.454-1.151-1.11-1.458-1.11-1.458-.908-.618.069-.606.069-.606 1.003.07 1.531 1.027 1.531 1.027.892 1.524 2.341 1.084 2.91.828.092-.643.35-1.083.636-1.332-2.22-.251-4.555-1.107-4.555-4.927 0-1.088.39-1.979 1.029-2.675-.103-.252-.446-1.266.098-2.638 0 0 .84-.268 2.75 1.022A9.606 9.606 0 0112 6.82c.85.004 1.705.114 2.504.336 1.909-1.29 2.747-1.022 2.747-1.022.546 1.372.202 2.386.1 2.638.64.696 1.028 1.587 1.028 2.675 0 3.83-2.339 4.673-4.566 4.92.359.307.678.915.678 1.846 0 1.332-.012 2.407-.012 2.734 0 .267.18.577.688.48C19.137 20.107 22 16.373 22 11.969 22 6.463 17.522 2 12 2z">
                                </path>
                            </svg>
                        </a>

                        <a href="https://linkedin.com/in/thearyanahmed" title="thearyanahmed's linkedin"
                            class="text-gray-900 inline-flex items-center px-1 pt-1 text-base" target="_blank">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                class="bi bi-linkedin h-5 w-5 text-gray-800 hover:underline mr-3 text-opacity-50 transform"
                                viewBox="0 0 16 16">
                                <path
                                    d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z" />
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mobile menu, show/hide based on menu state. -->
        <div class="hidden dotted-bg" id="mobile-menu">
            <div class="pt-6 pb-4 space-y-1">
                <a href="https://thearyanahmed.com"
                    class="font-semibold border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 block pl-3 pr-4 py-2 border-l-4 text-base">home</a>
                <a href="https://thearyanahmed.com/writings" title="Technical Writings"
                    class="font-semibold border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 block pl-3 pr-4 py-2 border-l-4 text-base">
                    technical writings</a>

                <a href="https://thearyanahmed.com/abcd" title="ABCD for Kids"
                    class="font-semibold border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 block pl-3 pr-4 py-2 border-l-4 text-base">
                    abcd</a>

                

                

                <a href="https://github.com/thearyanahmed" target="_blank"
                    class="font-semibold border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 block pl-3 pr-4 py-2 border-l-4 text-base">Github</a>

                <a href="https://linkedin.com/in/thearyanahmed" target="_blank"
                    class="font-semibold border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 block pl-3 pr-4 py-2 border-l-4 text-base">Linkedin</a>

            </div>
        </div>
    </nav>

</div>

    <main class="lg:relative">
        <div class="max-w-3xl mx-auto px-4 mt-8">
        <div class="relative py-16 bg-white overflow-hidden rounded-lg">
            <div class="hidden lg:block lg:absolute lg:inset-y-0 lg:h-full lg:w-full dotted-bg">
                <div class="relative h-full text-lg max-w-prose mx-auto" aria-hidden="true">
                    <svg class="absolute top-12 left-full transform translate-x-32" width="404" height="384" fill="none"
                         viewBox="0 0 404 384">
                        <defs>
                            <pattern id="74b3fd99-0a6f-4271-bef2-e80eeafdf357" x="0" y="0" width="20" height="20"
                                     patternUnits="userSpaceOnUse">
                                <rect x="0" y="0" width="4" height="4" class="text-gray-200" fill="currentColor"/>
                            </pattern>
                        </defs>
                        <rect width="404" height="384" fill="url(#74b3fd99-0a6f-4271-bef2-e80eeafdf357)"/>
                    </svg>
                    <svg class="absolute top-1/2 right-full transform -translate-y-1/2 -translate-x-32" width="404"
                         height="384" fill="none" viewBox="0 0 404 384">
                        <defs>
                            <pattern id="f210dbf6-a58d-4871-961e-36d5016a0f49" x="0" y="0" width="20" height="20"
                                     patternUnits="userSpaceOnUse">
                                <rect x="0" y="0" width="4" height="4" class="text-gray-200" fill="currentColor"/>
                            </pattern>
                        </defs>
                        <rect width="404" height="384" fill="url(#f210dbf6-a58d-4871-961e-36d5016a0f49)"/>
                    </svg>
                    <svg class="absolute bottom-12 left-full transform translate-x-32" width="404" height="384"
                         fill="none" viewBox="0 0 404 384">
                        <defs>
                            <pattern id="d3eb07ae-5182-43e6-857d-35c643af9034" x="0" y="0" width="20" height="20"
                                     patternUnits="userSpaceOnUse">
                                <rect x="0" y="0" width="4" height="4" class="text-gray-200" fill="currentColor"/>
                            </pattern>
                        </defs>
                        <rect width="404" height="384" fill="url(#d3eb07ae-5182-43e6-857d-35c643af9034)"/>
                    </svg>
                </div>
            </div>
            <div class="relative px-4 sm:px-6 lg:px-8">
                <div class="text-lg max-w-prose mx-auto">
                    <h1 class="mt-2 block text-6xl text-center fredericka-the-great tracking-tight text-gray-900">
                        Managing Dotfiles and Sensitive Environment Variables: A Workaround 
                    </h1>
                </div>

                
                <div class="text-lg max-w-prose mx-auto">
                    <p class="mt-8 text-xl text-gray-500 leading-8">
                        The ProblemShell RC file এর থাকা Secret Token বা API Key কি git এ commit করেন? করলে github/lab এর flag করার কথা। কিছু API key/token sh...
                    </p>
                </div>
                <div
                    class="article-content-markdown mt-6 prose prose-indigo prose-lg text-gray-800 mx-auto">
                    <h2>The ProblemShell RC file এর থাকা Secret Token বা API Key কি git এ commit করেন? করলে github/lab এর flag করার কথা। কিছু API key/token shell file এ থাকা লাগে often (কিছু program আছে যেটা environment variable থেকে নিয়ে । আর প্রতিবার env variable pass করা ঝামেলা । Alternative option হলো something like 1password open করে copy paste করা । Not a fan of that.</h2>
<p>যেমন, DigitalOcean API গুলোতে curl request দেয়া আছে যেটা <strong>DIGITALOCEAN_TOKEN</strong> নিয়ে কাজ করে । Env এ setup করা থাকলে curl request টা শুধু copy করলেই হয়ে যায়।</p>
<p>আমার বেশ কয়েকবার এরকম হয়েছে যে নতুন environment এ বা ২ টা machine থেকে কাজ করতে গিয়ে .bashrc বা .zshrc file হারিয়ে গেছে । আর তখন ( বা অনেক সময় ) খেয়াল থাকে না কি কি environment variable ছিলো । আবার আগের মত setup এর জন্য একি variable name করতে হয় । যেটা আরেকটা hassle.</p>
<p>At least আমার কাছে hassle. তাই আমি ভাবছিলাম, dot files গুলোর সাথে যদি একটা private file ও commit করা যেতো, যেটাতে আমার secret env variable গুলো থাকবে । কিন্ত value commit করতে চাচ্ছি না ।</p>
<h2>The Solution (kinda)তাই একটা bash script add করেছি, যেটা git এর pre-commit hook এ run করে KEY গুলো রেখে value গুলো strip করে ফেলে । আর commit হলে গেলে, আরেকটা post-commit hook এর মাধ্যমে original value টা আবার restore করে দেয় ।</h2>
<p>আর আমার local এ private.original একটা file এ original file টা রেখে দেয়, যেটা থেকে আবার restore করতে পারে । private.original টা .gitignore এ রাখা। So, no keys are pushed to version control.</p>
<p>Not that fancy, but আমার জন্য, একটা problem এর solution. :D</p>
<p>যদি আপনার এরকম কিছুর প্রয়োজন হয়, feel free to take a look the code.</p>
<h4>Pre-commit hook```</h4>
<h1>!/bin/bash</h1>
<h1>pre-commit hook</h1>
<h1>Set the path to the file you want to process</h1>
<p>FILE_PATH=&quot;zsh/private&quot;</p>
<h1>Check if the file exists</h1>
<p>if [ ! -f &quot;$FILE_PATH&quot; ]; then
echo &quot;Error: File '$FILE_PATH' not found.&quot;
exit 1
fi</p>
<h1>Check if the file has been modified in the staging area</h1>
<p>if ! git diff --cached --name-only | grep -q &quot;$FILE_PATH&quot;; then
echo &quot;File '$FILE_PATH' not modified. Skipping secret stripping.&quot;
exit 0
fi</p>
<h1>Create a backup of the original file</h1>
<p>ORIGINAL_FILE_PATH=&quot;private.original&quot;</p>
<h1>backup</h1>
<p>cat &quot;$FILE_PATH&quot; &gt; &quot;$ORIGINAL_FILE_PATH&quot;</p>
<h1>Create a temporary file to store the modified content</h1>
<p>TEMP_FILE=$(mktemp)</p>
<h1>Process the file line by line</h1>
<p>while IFS= read -r line; do
if [[ &quot;$line&quot; =~ ^[^#]*= ]]; then</p>
<h1>If the line contains an assignment (key=value), strip the value</h1>
<pre><code>key=$(echo "$line" | cut -d'=' -f1)
echo "$key=\"\"" &gt;&gt; "$TEMP_FILE"</code></pre>
<p>else</p>
<h1>Otherwise, keep the line as it is (comments, empty lines, etc.)</h1>
<pre><code>echo "$line" &gt;&gt; "$TEMP_FILE"</code></pre>
<p>fi
done &lt; &quot;$FILE_PATH&quot;</p>
<h1>Replace the original file with the modified content</h1>
<p>mv &quot;$TEMP_FILE&quot; &quot;$FILE_PATH&quot;</p>
<p>echo &quot;Stripped values in '$FILE_PATH'.&quot;</p>
<h1>Add the modified file to the staging area</h1>
<p>git add &quot;$FILE_PATH&quot;</p>
<p>echo &quot;Staged stripped secrets.&quot;</p>
<h1>Allow the commit to continue. The commit message will be modified after this hook completes.</h1>
<p>exit 0
<code>#### Post-commit hook</code></p>
<h1>!/bin/bash</h1>
<h1>post-commit hook</h1>
<p>FILE_PATH=&quot;zsh/private&quot;
ORIGINAL_FILE_PATH=&quot;private.original&quot;</p>
<p>if [ -f &quot;$ORIGINAL_FILE_PATH&quot; ]; then</p>
<h1>Replace instead of concat</h1>
<pre><code>cat "$ORIGINAL_FILE_PATH" &gt; "$FILE_PATH"
echo "Original private file restored after commit."</code></pre>
<p>else
echo &quot;Original private file backup not found. Skipping restore.&quot;
fi</p>
<p>exit 0</p>
<pre><code class="language-Test">

![](https://substackcdn.com/image/fetch/$s_!qTpv!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F97756404-a8a7-43f4-8432-c0f5c5c74b8f_1896x1410.png)আর এটা পুশ করার পরে github এ গিয়ে check করলে দেখতে পাচ্ছি

![](https://substackcdn.com/image/fetch/$s_!S5eV!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F55d274b3-8385-4cd7-88a6-f7489961aa73_2402x398.png)আপনার যদি অল্প কিছু env variable থাকে plus একাধিক environment এ কাজ করতে না হয়, তাহলে এই approach unnecessary. আমার কয়েকশো env variable এর মত হয়েছে যেগুলো over the years আমার setup এর জন্য use করি।

Thanks for reading until this bit! Feel free to subscribe for free to receive new posts and support my work.

এছাড়া আমার কিছু dotfiles (shortcuts/alias/functions/settings) এখানে পাবেন

[https://github.com/thearyanahmed/dotfiles](https://github.com/thearyanahmed/dotfiles) । বর্তমানে এটা incomplete. তবে আমি আমার dotfiles গুলো overtime collect করে share করবো inshallah. 

![](https://substackcdn.com/image/fetch/$s_!BAXj!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8e7cf956-d717-4484-b836-d596ba8d6263_2602x2898.png)However, আমি কি এটা নিয়ে happy ? পুরোপুরি না। তাই maybe I should build something a bit more … um manageable? 

আমার অন্য কিছু article</code></pre>
                </div>
            </div>
        </div>

        
        <div class="h-20"></div>
    </div>
    </main>

    <!-- Calendly link widget begin -->
        <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
        <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>

        <!-- Highlight.js for syntax highlighting -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>

        <script type="module">
            const imgs = document.getElementsByTagName('img')

            for (let i = 0; i < imgs.length; i++) {
                const img = imgs[i]

                let src = img.getAttribute('src')

                if (src.startsWith('art::')) {
                    src = src.replace('art::', 'https://raw.githubusercontent.com/thearyanahmed/art/master/')
                    img.setAttribute('src', src)
                }
            }
        </script>

    <script src="https://thearyanahmed.com/js/functions.js"></script>
    <footer class="max-w-lg mx-auto flex text-center mb-20">
        <div class="flex flex-col mx-auto text-gray-300">
            <span>
                v<span class="text-gray-400">2.27.0</span>
            </span>
            <span class="text-sm"><span class="text-gray-500/60">331</span>ヅ<span class="text-gray-500/60">ddd178719a0e56174264354fe989455d654d4614</span></span>
        </div>
    </footer>
</body>

</html>
