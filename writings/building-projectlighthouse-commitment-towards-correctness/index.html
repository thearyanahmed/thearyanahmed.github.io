<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <meta name="author" content="Aryan Ahmed" />
<meta name="author" content="Aryan Ahmed" />
<meta name="author" content="Aryan Ahmed" />
<meta name="author" content="Aryan Ahmed" />
<meta property="og:type" content="website" />
<title>Building projectlighthouse - commitment towards correctness</title>
<meta property="og:title" content="Building projectlighthouse - commitment towards correctness" />
<meta name="twitter:title" content="Building projectlighthouse - commitment towards correctness" />
<meta name="embedx:title" content="Building projectlighthouse - commitment towards correctness" />
<meta name="description" content="This is a highly opinionated article, part of a series &quot;Building projectlighthouse&quot;. I was working on a CLI that interacts with projectlighthouse via API, written in Rust, with a strong commitment towards correctness in software development." />
<meta property="og:description" content="This is a highly opinionated article, part of a series &quot;Building projectlighthouse&quot;. I was working on a CLI that interacts with projectlighthouse via API, written in Rust, with a strong commitment towards correctness in software development." />
<meta name="twitter:description" content="This is a highly opinionated article, part of a series &quot;Building projectlighthouse&quot;. I was working on a CLI that interacts with projectlighthouse via API, written in Rust, with a strong commitment towards correctness in software development." />
<meta name="embedx:description" content="This is a highly opinionated article, part of a series &quot;Building projectlighthouse&quot;. I was working on a CLI that interacts with projectlighthouse via API, written in Rust, with a strong commitment towards correctness in software development." />
<meta name="author" content="Aryan Ahmed" />
<meta name="twitter:card" content="This is a highly opinionated article, part of a series &quot;Building projectlighthouse&quot;. I was working on a CLI that interacts with projectlighthouse via API, written in Rust, with a strong commitment towards correctness in software development." />
<meta property="og:site_name" content="thearyanahmed.com" />
<link rel="canonical" href="https://thearyanahmed.substack.com/p/building-projectlighthouse-commitment" />
<meta property="article:Building projectlighthouse - commitment towards correctness" content="Building projectlighthouse - commitment towards correctness" />

    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
    <link href="https://thearyanahmed.com/css/app.css" rel="stylesheet">

    

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-90CDQWTTNW"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'G-90CDQWTTNW');
</script>
</head>

<body class="antialiased dotted-bg text-slate-500 dark:text-slate-400 bg-white dark:bg-slate-900">

    <div
    class="notsticky top-0 z-40 w-full backdrop-blur flex-none transition-colors duration-500 lg:z-50 bg-white/95 supports-backdrop-blur:bg-white/60 dark:bg-transparent">
    <nav class="w-full mx-auto bg-white">
        <div class="px-2 sm:px-6 lg:px-8 dotted-bg">
            <div class="relative flex justify-between h-16">
                <div class="absolute inset-y-0 left-0 flex items-center sm:hidden">
                    <!-- Mobile menu button -->
                    <button onclick="toggleMobileMenu()" type="button"
                        class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-gray-500"
                        aria-controls="mobile-menu" aria-expanded="false">
                        <span class="sr-only">Open main menu</span>
                        <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 6h16M4 12h16M4 18h16" />
                        </svg>

                        <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                <div class="flex-1 flex items-center justify-center sm:items-stretch sm:justify-start">
                    <div class="justify-center w-full mx-auto hidden sm:ml-6 sm:flex sm:space-x-8">
                        <a href="https://thearyanahmed.com" title="thearyanahmed's blog" target="_self"
                            class="text-gray-800 hover:underline font-semibold text-opacity-75 inline-flex items-center px-1 pt-1 text-base">
                            home
                        </a>
                        <a href="https://thearyanahmed.com/writings" title="Technical Writings"
                            class="text-gray-800 hover:underline font-semibold text-opacity-75 inline-flex items-center px-1 pt-1 text-base">
                            technical writings
                        </a>
                        <a href="https://thearyanahmed.com/abcd" title="ABCD for Kids"
                            class="text-gray-800 hover:underline font-semibold text-opacity-75 inline-flex items-center px-1 pt-1 text-base">
                            abcd for kids
                        </a>

                        
                        


                        <a href="https://github.com/thearyanahmed" title="thearyanahmed's github"
                            class="text-gray-900 inline-flex items-center px-1 pt-1 text-base" target="_blank">
                            <svg width="24" height="24" fill="currentColor"
                                class="text-gray-800 hover:underline mr-3 text-opacity-50 transform">
                                <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M12 2C6.477 2 2 6.463 2 11.97c0 4.404 2.865 8.14 6.839 9.458.5.092.682-.216.682-.48 0-.236-.008-.864-.013-1.695-2.782.602-3.369-1.337-3.369-1.337-.454-1.151-1.11-1.458-1.11-1.458-.908-.618.069-.606.069-.606 1.003.07 1.531 1.027 1.531 1.027.892 1.524 2.341 1.084 2.91.828.092-.643.35-1.083.636-1.332-2.22-.251-4.555-1.107-4.555-4.927 0-1.088.39-1.979 1.029-2.675-.103-.252-.446-1.266.098-2.638 0 0 .84-.268 2.75 1.022A9.606 9.606 0 0112 6.82c.85.004 1.705.114 2.504.336 1.909-1.29 2.747-1.022 2.747-1.022.546 1.372.202 2.386.1 2.638.64.696 1.028 1.587 1.028 2.675 0 3.83-2.339 4.673-4.566 4.92.359.307.678.915.678 1.846 0 1.332-.012 2.407-.012 2.734 0 .267.18.577.688.48C19.137 20.107 22 16.373 22 11.969 22 6.463 17.522 2 12 2z">
                                </path>
                            </svg>
                        </a>

                        <a href="https://linkedin.com/in/thearyanahmed" title="thearyanahmed's linkedin"
                            class="text-gray-900 inline-flex items-center px-1 pt-1 text-base" target="_blank">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                class="bi bi-linkedin h-5 w-5 text-gray-800 hover:underline mr-3 text-opacity-50 transform"
                                viewBox="0 0 16 16">
                                <path
                                    d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z" />
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mobile menu, show/hide based on menu state. -->
        <div class="hidden dotted-bg" id="mobile-menu">
            <div class="pt-6 pb-4 space-y-1">
                <a href="https://thearyanahmed.com"
                    class="font-semibold border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 block pl-3 pr-4 py-2 border-l-4 text-base">home</a>
                <a href="https://thearyanahmed.com/writings" title="Technical Writings"
                    class="font-semibold border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 block pl-3 pr-4 py-2 border-l-4 text-base">
                    technical writings</a>

                <a href="https://thearyanahmed.com/abcd" title="ABCD for Kids"
                    class="font-semibold border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 block pl-3 pr-4 py-2 border-l-4 text-base">
                    abcd</a>

                

                

                <a href="https://github.com/thearyanahmed" target="_blank"
                    class="font-semibold border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 block pl-3 pr-4 py-2 border-l-4 text-base">Github</a>

                <a href="https://linkedin.com/in/thearyanahmed" target="_blank"
                    class="font-semibold border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 block pl-3 pr-4 py-2 border-l-4 text-base">Linkedin</a>

            </div>
        </div>
    </nav>

</div>

    <main class="lg:relative">
        <div class="max-w-3xl mx-auto px-4 mt-8">
        <div class="relative py-16 bg-white overflow-hidden rounded-lg">
            <div class="relative px-4 sm:px-6 lg:px-8">
                <div class="text-lg max-w-prose mx-auto">
                    <h1 class="mt-2 block text-6xl text-center fredericka-the-great tracking-tight text-gray-900">
                        Building projectlighthouse - commitment towards correctness 
                    </h1>
                </div>

                
                <div class="text-lg max-w-prose mx-auto">
                    <p class="mt-8 text-xl text-gray-500 leading-8">
                        This is a highly opinionated article, part of a series &quot;Building projectlighthouse&quot;. I was working on a CLI that interacts with projectlighthouse via API, written in Rust, with a strong commitment towards correctness in software development.
                    </p>
                </div>
                <div class="article-content-markdown mt-6 prose prose-indigo prose-lg text-gray-800 mx-auto">
                    <p>I was working on a CLI that interacts with <a href="https://projectlighthouse.io/">projectlighthouse</a> via API. The CLI is written in Rust. One of the things that I want is <strong>&quot;correctness&quot;</strong>. Even for small things. And since lighthouse is my own project, I want to ensure that as much as I can. Obviously I can't guarantee nor do I expect that it will be a completely correct program, still.</p>
<p>There's another reason - in many of Bangladesh's skill-based ed-Tech platforms, mainly the <strong>tech-&quot;edTech&quot;</strong> ones, you often see errors on the welcome page first, and the page may or may not load afterwards. In many cases there are manual features, which sometimes require learners to contact customer support, sometimes wait, sometimes the experience is not good. Often it's not good.</p>
<p>Thanks for reading Aryan's Journal! Subscribe for free to receive new posts and support my work. These are based on my first hand observation.</p>
<p>On one hand, many people complain that we are far behind. But on the other hand, the solutions that are coming are not in good shape either - that error on the welcome page first thing.</p>
<p>I think the people of Bangladesh deserve better than this.</p>
<p>So, I was working on a CLI that will be released as a binary. And its API will work with a remote server. The remote server's URL will be known through environment variables. Environment variable because when I develop locally, the URL is likely <code>localhost</code>.</p>
<p>So at the beginning, a function that will hold some values to initialize the API client: <code>base_url</code>, <code>environment</code> and <code>api_version</code>. This article is about <code>base_url</code>. It will likely be something like <code>https://projectlighthouse.io/api</code> or <code>/something</code>, but the CLI (binary) that learners will use will always call <code>projectlighthouse.io</code> (as of current plan), focusing on the domain, not the uri path.</p>
<p>So the initial code:</p>
<p><img src="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F173e0db6-b8ae-4f35-a799-09b0d2cb153c_2166x854.png" alt="" /></p>
<p>But since we'll need <code>localhost</code> in the development environment, I'm taking the value from env instead of hardcoding it.</p>
<p><img src="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff79bb65a-0c99-41ec-896e-ff4366937448_2170x210.png" alt="" /></p>
<p>And it works. But, what is stopping me from setting:</p>
<p><img src="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa9447ace-d218-4db6-b019-5e407f7dafc8_2180x194.png" alt="" /></p>
<p>Or, when some bad actor attempts some malicious act, could they set something like <code>LUX_API_BASE_URL=https://badactor.gonnastealyourdata.com</code> and run <code>lux auth --something</code>? Could be a social engineering attack as well? No?</p>
<blockquote>
<p>By the way, <code>lux</code> is the name of the CLI.</p>
</blockquote>
<p>Well, how likely is this scenario? I will probably set up a GitHub action or some automation script once that sets <code>LUX_API_BASE_URL</code> to <code>https://projectlighthouse.io/api</code>. And then likely no one will change it again. And, there's no critical data here that a hacker would come and try to hack. At least not yet, some features might be different in the future.</p>
<h3>…but,</h3>
<p>I think the people of Bangladesh deserve better than this. Just like the machines deserve better software for it to run.</p>
<h2>How to solve it</h2>
<p>Those who think this is not a waste of time, many of you might think, this can be solved just by writing a validation. And yes, that's the solution, but it's part of the solution. This won't be completely right until we ensure that <code>base_url</code> is of a very specific type. Then we can validate it with the type. Kinda like we don't have to validate this code to see if it's correct or not:</p>
<p><img src="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff804f0e5-3f96-420b-b48a-4039f6950eb5_2174x324.png" alt="" /></p>
<p>This won't compile. Because adding the string &quot;Hello&quot; with the number 10 is not logical. Unless you are writing JavaScript (which is also not logical &gt;_&lt;). Let's define our base api struct:</p>
<p><img src="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9beb0922-29a2-478e-94e7-ec17c6b2e7b5_2178x210.png" alt="" /></p>
<p>In Rust's language, this is called a <strong>tuple struct</strong>.</p>
<blockquote>
<p>Rust also supports structs that look similar to tuples, called <em>tuple structs</em>. Tuple structs have the added meaning the struct name provides but don't have names associated with their fields; rather, they just have the types of the fields.</p>
</blockquote>
<p><em>From</em> <strong>The Rust Book</strong> (<a href="https://doc.rust-lang.org/book/ch05-01-defining-structs.html#using-tuple-structs-without-named-fields-to-create-different-types">source</a>)</p>
<p>Tuple structs don't have named fields (properties). We will now use a tuple struct to construct a <code>LighthouseAPIBaseURL</code> type from a string.</p>
<p><img src="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ffe793e91-acf9-4d46-9003-794eb7f5e12f_2168x1686.png" alt="" /></p>
<p>We are exposing a <code>from()</code> method in the tuple struct, which executes the validation logic and returns a <code>Result&lt;Self = LighthouseAPIBaseURL, String&gt;</code>.</p>
<h2>Don't unwrap()</h2>
<p>We could have used <code>unwrap()</code> here if we wanted. But who knows, if projectlighthouse becomes a billion $ company like Cloudflare someday, we won't lose millions of dollars because of one unwrap.</p>
<h3>Cloudflare outage, unwrap() somewhat responsible</h3>
<ul>
<li>
<p>&quot;In this case, the 3 hour 20 minute outage could have direct and indirect losses of around $250 million to $300 million when you consider the cost of down-time and the downstream effects of services like Shopify or Etsy that host the stores for tens to hundreds of thousands of businesses.&quot; - <a href="https://www.cnet.com/tech/services-and-software/cloudflare-ceo-apologizes-for-unacceptable-outage-and-explains-what-went-wrong/">Report by CNET</a></p>
</li>
<li>
<p>Outage details: <a href="https://blog.cloudflare.com/18-november-2025-outage/">Cloudflare outage on November 18, 2025</a></p>
</li>
</ul>
<p>Back to our rust code, we've implemented the validation logic. If we break down the logic, it comes to this: based on the environment, we're defining different regex patterns. And then we're matching the environment value <code>LUX_API_BASE_URL</code> set by the user (me) against that regex pattern with <code>if re.is_match(base_url) {...}</code>.</p>
<p>Now, we will initialize the actual API client. First read the environment, and construct the <code>base_url</code> with it. But this time the base url is not a <code>string</code>. This time it's very specifically something in the <code>projectlighthouse.io</code> domain. Which I own.</p>
<p><img src="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff087964f-4904-491c-89ba-91913f30e86e_1572x2082.png" alt="" /></p>
<p>And now, if I give the wrong URL when releasing, <strong>I'll get a compile time error</strong>. Better to fail then, than failing at user's end. And finally, I don't know if this regex is 100% accurate. Regex still feels like German / Welsh language to me. However, I can write some tests that will increase my confidence in this regex.</p>
<p><img src="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F9d8e43e1-5907-4b59-b937-eb9c3adf1800_1552x1198.png" alt="" /></p>
<h2>Was it too much?</h2>
<p>For me, no. This is a very small code base, maybe no one will even use it. Maybe they will. If they do, I can give some extra guarantee that:</p>
<ul>
<li>When someone installs or updates something new, they won't get <code>unreachable api</code> or <code>wrong api</code> url.</li>
<li>If a hacker comes and tries to do something bad, their requests won't be sent. Because it won't compile.</li>
</ul>
<h2>Verdict</h2>
<p>Although this is a very small use-case, correctness is not something that we'll do later or when a bug is caught.</p>
<blockquote>
<p>Correctness is a culture. Correctness is the cost of not coming back to fix it later.</p>
</blockquote>
<p>I'll end with a quote from Chernobyl, I think they are similar, or we can think of them similarly…</p>
<blockquote>
<p>&quot;We're on dangerous ground right now, because of our secrets and our lies. They are practically what defines us. When the truth offends, we lie and lie until we can no longer remember it is even there. But it is still there. Every lie we tell incurs a debt to the truth. Sooner or later, that debt is paid.&quot;</p>
</blockquote>
<h3>Notes</h3>
<ul>
<li>I've used images instead of code because substack's code formatting is not good.</li>
<li>This article is a commitment towards correctness. If you find something wrong in lighthouse in the future, at least raise that.</li>
</ul>
<hr />
<p>Thanks for reading Aryan's Journal! Subscribe for free to receive new posts and support my work.</p>
                </div>
            </div>
        </div>

        
        <div class="h-20"></div>
    </div>
    </main>

    <!-- Calendly link widget begin -->
        <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
        <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>

        <!-- Highlight.js for syntax highlighting -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>

        <script type="module">
            const imgs = document.getElementsByTagName('img')

            for (let i = 0; i < imgs.length; i++) {
                const img = imgs[i]

                let src = img.getAttribute('src')

                if (src.startsWith('art::')) {
                    src = src.replace('art::', 'https://raw.githubusercontent.com/thearyanahmed/art/master/')
                    img.setAttribute('src', src)
                }
            }
        </script>

    <script src="https://thearyanahmed.com/js/functions.js"></script>
    <footer class="max-w-lg mx-auto flex text-center mb-20">
        <div class="flex flex-col mx-auto text-gray-300">
            <span>
                v<span class="text-gray-400">2.27.0</span>
            </span>
            <span class="text-sm"><span class="text-gray-500/60">341</span>ヅ<span class="text-gray-500/60">2f9ebfc5f133433948281ad4d3e3e67199cd0b0a</span></span>
        </div>
    </footer>
</body>

</html>
